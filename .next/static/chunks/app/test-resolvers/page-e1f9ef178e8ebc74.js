(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{8275:function(e,n,l){Promise.resolve().then(l.bind(l,3620))},3620:function(e,n,l){"use strict";l.r(n),l.d(n,{default:function(){return c}});var t=l(7437),i=l(2265),a=l(5133);function s(e){var n,l,t,i,s,r,d;let o=e.trim().toUpperCase(),{speciesCodes:u,species:c,sizes:p,forms:x}=(0,a.V)(),h=u.find(e=>e.code.toUpperCase()===o);if(!h)return null;let v=null!==(n=c.find(e=>e.id===h.species_id))&&void 0!==n?n:null,g=null!==(l=p.find(e=>e.id===h.size_id))&&void 0!==l?l:null,j=null!==(t=x.find(e=>e.id===h.form_id))&&void 0!==t?t:null;return{code:h.code,description_en:null!==(i=null==v?void 0:v.name_en)&&void 0!==i?i:"",size:null!==(s=null==g?void 0:g.name)&&void 0!==s?s:"",form:null!==(r=null==j?void 0:j.name)&&void 0!==r?r:"",scientific_name:null!==(d=null==v?void 0:v.scientific_name)&&void 0!==d?d:""}}function r(e){let{open:n,title:l,onClose:i,children:a}=e;return n?(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl w-full max-w-3xl p-5 shadow-xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:l}),(0,t.jsx)("button",{onClick:i,className:"px-3 py-1 border rounded",children:"Cerrar"})]}),a]})}):null}var d=l(4873);function o(e){let{open:n,presetCode:l="",onClose:a,onCreated:s}=e,[o,u]=(0,i.useState)({code:l,name:"",address:"",city:"",state:"",country:"USA",zip:"",tax_id:""}),[c,p]=(0,i.useState)(!1),[x,h]=(0,i.useState)(null),v=(e,n)=>u(l=>({...l,[e]:n})),g=async()=>{if(h(null),!o.code.trim()||!o.name.trim()){h("Code and Name are required");return}p(!0);try{let e=await (0,d.Z)("/api/catalogs/client",{method:"POST",body:JSON.stringify(o)});s(e.client),a()}catch(n){var e;h(String(null!==(e=n.message)&&void 0!==e?e:n))}finally{p(!1)}};return(0,t.jsx)(r,{open:n,title:"New Client",onClose:a,children:(0,t.jsxs)("div",{style:{display:"grid",gap:10},children:[x&&(0,t.jsx)("div",{style:{color:"#b00"},children:x}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",gap:8},children:[(0,t.jsx)("label",{children:"Code*"}),(0,t.jsx)("input",{value:o.code,onChange:e=>v("code",e.target.value.toUpperCase())}),(0,t.jsx)("label",{children:"Name*"}),(0,t.jsx)("input",{value:o.name,onChange:e=>v("name",e.target.value)}),(0,t.jsx)("label",{children:"Address"}),(0,t.jsx)("input",{value:o.address,onChange:e=>v("address",e.target.value)}),(0,t.jsx)("label",{children:"City"}),(0,t.jsx)("input",{value:o.city,onChange:e=>v("city",e.target.value)}),(0,t.jsx)("label",{children:"State"}),(0,t.jsx)("input",{value:o.state,onChange:e=>v("state",e.target.value)}),(0,t.jsx)("label",{children:"Country"}),(0,t.jsx)("input",{value:o.country,onChange:e=>v("country",e.target.value)}),(0,t.jsx)("label",{children:"ZIP"}),(0,t.jsx)("input",{value:o.zip,onChange:e=>v("zip",e.target.value)}),(0,t.jsx)("label",{children:"Tax ID"}),(0,t.jsx)("input",{value:o.tax_id,onChange:e=>v("tax_id",e.target.value)})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,t.jsx)("button",{onClick:a,disabled:c,children:"Cancel"}),(0,t.jsx)("button",{onClick:g,disabled:c,children:c?"Saving...":"Save"})]})]})})}function u(e){let{open:n,presetCode:l="",onClose:a,onCreated:s}=e,[o,u]=(0,i.useState)({code:l,name_en:"",scientific_name:"",size:"",form:"W&G"}),[c,p]=(0,i.useState)(!1),[x,h]=(0,i.useState)(null),v=(e,n)=>u(l=>({...l,[e]:n})),g=async()=>{if(h(null),!o.code.trim()||!o.name_en.trim()||!o.size.trim()){h("Code, Name EN and Size are required");return}p(!0);try{let e=await (0,d.Z)("/api/catalogs/species-bundle",{method:"POST",body:JSON.stringify({...o,code:o.code.toUpperCase()})});s({map:e.map,species:e.species,size:e.size,form:e.form}),a()}catch(n){var e;h(String(null!==(e=n.message)&&void 0!==e?e:n))}finally{p(!1)}};return(0,t.jsx)(r,{open:n,title:"New Species (by key)",onClose:a,children:(0,t.jsxs)("div",{style:{display:"grid",gap:10},children:[x&&(0,t.jsx)("div",{style:{color:"#b00"},children:x}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"160px 1fr",gap:8},children:[(0,t.jsx)("label",{children:"Key (code)*"}),(0,t.jsx)("input",{value:o.code,onChange:e=>v("code",e.target.value.toUpperCase())}),(0,t.jsx)("label",{children:"Name EN*"}),(0,t.jsx)("input",{value:o.name_en,onChange:e=>v("name_en",e.target.value)}),(0,t.jsx)("label",{children:"Scientific name"}),(0,t.jsx)("input",{value:o.scientific_name,onChange:e=>v("scientific_name",e.target.value.toUpperCase())}),(0,t.jsx)("label",{children:"Size*"}),(0,t.jsx)("input",{value:o.size,onChange:e=>v("size",e.target.value)}),(0,t.jsx)("label",{children:"Form"}),(0,t.jsx)("input",{value:o.form,onChange:e=>v("form",e.target.value)})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,t.jsx)("button",{onClick:a,disabled:c,children:"Cancel"}),(0,t.jsx)("button",{onClick:g,disabled:c,children:c?"Saving...":"Save"})]})]})})}function c(){let[e,n]=(0,i.useState)(""),[l,r]=(0,i.useState)(""),d=function(){let[e,n]=(0,i.useState)(!1),[l,s]=(0,i.useState)(null),[r,d]=(0,i.useState)(null);return{ask:e=>{let l=function(e){var n;let l=e.trim().toUpperCase(),{clients:t}=(0,a.V)();return null!==(n=t.find(e=>e.code.toUpperCase()===l))&&void 0!==n?n:null}(e);return l?(d(l),{ok:!0,client:l}):(s(e),n(!0),{ok:!1})},modal:(0,t.jsx)(o,{open:e,presetCode:null!=l?l:"",onClose:()=>n(!1),onCreated:e=>{d(e),n(!1)}}),resolved:r}}(),c=function(){let[e,n]=(0,i.useState)(!1),[l,a]=(0,i.useState)(null),[r,d]=(0,i.useState)(null);return{ask:e=>{let l=s(e);return l?(d(l),{ok:!0,data:l}):(a(e),n(!0),{ok:!1})},modal:(0,t.jsx)(u,{open:e,presetCode:null!=l?l:"",onClose:()=>n(!1),onCreated:()=>{d(s(null!=l?l:"")),n(!1)}}),resolved:r}}();return(0,t.jsxs)("main",{style:{padding:24,display:"grid",gap:24},children:[(0,t.jsx)("h1",{children:"Resolver demo"}),(0,t.jsxs)("section",{style:{display:"grid",gap:8},children:[(0,t.jsx)("h3",{children:"Client"}),(0,t.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,t.jsx)("input",{placeholder:"Client code (e.g. HE)",value:e,onChange:e=>n(e.target.value)}),(0,t.jsx)("button",{onClick:()=>d.ask(e),children:"Resolve"})]}),d.resolved&&(0,t.jsx)("pre",{children:JSON.stringify(d.resolved,null,2)})]}),(0,t.jsxs)("section",{style:{display:"grid",gap:8},children:[(0,t.jsx)("h3",{children:"Species by key"}),(0,t.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,t.jsx)("input",{placeholder:"Species key (e.g. ARS1-22)",value:l,onChange:e=>r(e.target.value)}),(0,t.jsx)("button",{onClick:()=>c.ask(l),children:"Resolve"})]}),c.resolved&&(0,t.jsx)("pre",{children:JSON.stringify(c.resolved,null,2)})]}),d.modal,c.modal]})}},4873:function(e,n,l){"use strict";async function t(e,n){let l=await fetch(e,{credentials:"same-origin",...n});if(!l.ok){let e="";try{e=await l.text()}catch(e){}throw Error(e||"HTTP ".concat(l.status))}return l.json()}l.d(n,{Z:function(){return t}})}},function(e){e.O(0,[537,133,971,23,744],function(){return e(e.s=8275)}),_N_E=e.O()}]);